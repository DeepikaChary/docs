---
title: "Mobile Integrations - Push Notifications"
id: "mobile-integrations-push-notifications"
---

# Introduction

In this post, we will outline how to interact with Google Cloud Messaging (GCM) and push messages to a device.

# Procedure

### Step 1: Register your app with GCM Server and get Sender Id.

1. Go to [Google Developer Console](https://developers.google.com/mobile/add?platform=android&cntapi=gcm&cnturl=https:%2F%2Fdevelopers.google.com%2Fcloud-messaging%2Fandroid%2Fclient&cntlbl=Continue%20Adding%20GCM%20Support&%3Fconfigured%3Dtrue) and register your app name and app package(optional) click on continue. [![GCM_app_register](/learn/assets/GCM_app_register-1024x544.png)](/learn/assets/GCM_app_register.png)
2. You will get API Key ( needed when you push a message) and Sender Id as below and keep this data copied and safe which we need in further steps. [![GCM_app_API](/learn/assets/GCM_app_API-1024x651.png)](/learn/assets/GCM_app_API.png)

### Step 2: Create a mobile app with the SenderId from Step 1 and configure it to receive notifications

1. Create a Hybrid Mobile project in WaveMaker using the same app name that you registered with GCM server in the previous step. **Note**: As the project name containing special characters is not allowed in Google Developer Console, create the project in WaveMaker without any special character including ‘\_’. [![Selecting_mobile_app](/learn/assets/Selecting_mobile_app.png)](/learn/assets/Selecting_mobile_app.png)
2. Import the [gcm.server.jar](http://www.java2s.com/Code/Jar/g/gcm.htm) and [json-simple-1.1.1.jar](http://www.java2s.com/Code/Jar/j/json-simple.htm) files into your project using Import -> Jar option from Main Menu. [![JAR_import](/learn/assets/JAR_import.png)](/learn/assets/JAR_import.png) [![GCM_imp_res](/learn/assets/GCM_imp_res.png)](/learn/assets/GCM_imp_res.png)
3. Create a Java Service for push notification [![JS_Create](/learn/assets/JS_Create.png)](/learn/assets/JS_Create.png)

using the following code:

/\*Generated by WaveMaker Studio\*/

package com.pushnotify.service;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import java.util.ArrayList;
import com.google.android.gcm.server.Message;
import com.google.android.gcm.server.MulticastResult;
import com.google.android.gcm.server.Result;
import com.google.android.gcm.server.Sender;

//import com.pushnotify.service.model.\*;
import com.wavemaker.runtime.service.annotations.ExposeToClient;

/\*\*
 \* This is a singleton class with all of its public methods exposed to the client via controller.
 \* Their return values and parameters will be passed to the client or taken
 \* from the client respectively.
 \*/
@ExposeToClient
public class PushService {
   public String gcmNotification(String apiKey, String pushMessage, String deviceId) {
   	 try {
                    	//Please add here your project API key: "Key for browser apps (with referers)".
                    	Sender sender = new  Sender(apiKey);

                    	// use this to send message with payload data
                    	Message message = new Message.Builder()
                    	.collapseKey("message")
                    	.timeToLive(3)
                    	.delayWhileIdle(true)
                    	.addData("message", pushMessage) //you can get this message on client side app
                    	.build();  

                    	//Use this code to send notification message to multiple devices
                    	ArrayList<String> devicesList = new ArrayList<String>();       	 
                    	devicesList.add(deviceId);    //add your devices RegisterationID, one for each device    

                    	//Use this code for multicast messages    
                    	MulticastResult multicastResult = sender.send(message, devicesList, 0);
                    	System.out.println("Message Result: "+multicastResult.toString());//Print multicast message result on console
                   	 } catch (Exception e) {
                    	e.printStackTrace();
                	}
                	return pushMessage;
	}
}

1. In _app.js_, include the below code for registering the push notification: For more details, refer to [push API](https://github.com/phonegap/phonegap-plugin-push/blob/master/docs/API.md) [![GCM_appjs](/learn/assets/GCM_appjs.png)](/learn/assets/GCM_appjs.png)

//push notification initialization and registration. 
	if (!$window.PushNotification) {
    	return;
	}
	var push = $window.PushNotification.init({
    	android: {
        	senderID: "Include your app sender ID XXXXXXX” 
    	},
    	ios: {
        	alert: "true",
        	badge: true,
        	sound: 'false'
    	},
    	windows: {}
	});

	push.on('registration', function(data) {
    	// this gives the unique deviceId
    	$rootScope.registrationId = data.registrationId;

	});

	push.on('notification', function(data) {
    	console.log(data.message);
    	});

	push.on('error', function(e) {
    	console.log(e.message);
	});
	push.off('notification', function(e) {
    	console.log('off notify');
	});

	push.finish(function() {
    	console.log('success');
	}, function() {
    	console.log('error');
	}, 'push-1');

- To invoke the service create a push notification service variable. [![GCM_push_var](/learn/assets/GCM_push_var.png)](/learn/assets/GCM_push_var.png)
- The GCM Push Notification service requires API Key, sender ID, deviceID (or array of deviceId’s). [![GCM_push_vardata](/learn/assets/GCM_push_vardata.png)](/learn/assets/GCM_push_vardata.png)

 

### Step 5: Building Mobile App with required Cordova Plugin.

Install Cordova on your machines and once you have it ready then do following for mobile app of GCM:

1. Export Cordova Zip from WaveMaker
2. Unzip it and you see a _config.xml_ and two folders
3. Specify the plugin in config.xml [![GCM_plugin](/learn/assets/GCM_plugin.png)](/learn/assets/GCM_plugin.png)
4. Go to _cmd_ line and navigate to the unzipped folder
5. The run the below commands in sequence
    
    cordova platform add android
    cordova plugin add phonegap-plugin-push --variable SENDER\_ID="XXXXXXX"
    cordova build
    
6. Install the _apk_ file _from platforms/android/build/outputs/apk_ folder

B.4 Mobile Integrations

- [4.1 Amazon Cognito](/learn/hybrid-mobile/mobile-integrations/)
- [4.2 Amazon SNS](/learn/hybrid-mobile/mobile-integrations-amazon-sns/)
- [4.3 Amazon Mobile Analytics](/learn/hybrid-mobile/mobile-integrations-amazon-mobile-analytics/)
- [4.4 Push Notifications](/learn/hybrid-mobile/mobile-integrations-push-notifications/)
- [4.5 Invoking Web App API’s in Mobile Apps](/learn/mobile-app-development/invoking-web-app-apis-mobile-apps/)
